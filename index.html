<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sub Goal</title>

  <style>
    body {
      margin: 0;
      background: transparent;
      font-family: Arial, Helvetica, sans-serif;
    }

    .wrapper {
      padding: 12px 22px;
      background: #31af1e;
      border-radius: 14px;
      width: fit-content;
    }

    .goal {
      font-size: 66px;
      font-weight: 800;
      color: #ffffff;
      white-space: nowrap;
    }
  </style>
</head>

<body>
  <div class="wrapper">
    <div class="goal">
      Sub :- <span id="current">--</span> / <span id="goal">55</span>
    </div>
  </div>

  <script>
    const API_KEY = "AIzaSyCMpEWlw9wIaE7yQ8DoBBSge8TW6BpV_zU";
    const CHANNEL_ID = "UCEc2NqUesRfybaneYeGgtGw";
    const SUB_GOAL = 55;

    document.getElementById("goal").innerText = SUB_GOAL;

    const URL = `https://www.googleapis.com/youtube/v3/channels?part=statistics&id=${CHANNEL_ID}&key=${API_KEY}`;

    let currentSubs = null;

    function animateCount(start, end, duration = 700) {
      const startTime = performance.now();

      function update(now) {
        const progress = Math.min((now - startTime) / duration, 1);
        const value = Math.floor(start + (end - start) * progress);

        document.getElementById("current").innerText = value;

        if (progress < 1) requestAnimationFrame(update);
      }

      requestAnimationFrame(update);
    }

    async function fetchSubs() {
      try {
        const res = await fetch(URL);
        const data = await res.json();
        const newSubs = parseInt(
          data.items[0].statistics.subscriberCount
        );

        if (currentSubs === null) {
          document.getElementById("current").innerText = newSubs;
        } else if (newSubs !== currentSubs) {
          animateCount(currentSubs, newSubs);
        }

        currentSubs = newSubs;

      } catch (err) {
        document.getElementById("current").innerText = "Err";
        console.error(err);
      }
    }

    fetchSubs();
    setInterval(fetchSubs, 60000); // safe & professional
  </script>
</body>
</html>
